{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-20T17:31:55.643949Z", "invocation_id": "73cb61e7-7139-499d-b337-64a344c3f45c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:42.035252Z", "completed_at": "2024-11-20T17:31:42.044685Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:42.045106Z", "completed_at": "2024-11-20T17:31:50.331855Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.297526836395264, "adapter_response": {"_message": "CREATE TABLE (190.4k rows, 70.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 190408, "bytes_processed": 74048120, "bytes_billed": 74448896, "location": "US", "project_id": "data-engineering-439905", "job_id": "c8daf018-d52e-420c-8b38-ec6e5aa6c023", "slot_ms": 43145}, "message": "CREATE TABLE (190.4k rows, 70.6 MiB processed)", "failures": null, "unique_id": "model.bds_dbt.dim_bds", "compiled": true, "compiled_code": "\n\nWITH bds_data AS (\n    SELECT * \n    FROM `data-engineering-439905`.`batdongsan`.`thong_tin_ban_dat` as bds\n    WHERE bds.update_time NOT IN (' ', '')\n)\n\nSELECT \n    CASE WHEN TRIM(address_text) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(address_text) END as address\n    ,CASE WHEN TRIM(district) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(district) END as district\n    ,CASE WHEN TRIM(city) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(city) END as city\n    ,\n    CASE \n        WHEN REGEXP_REPLACE(price, r',', '.') LIKE '%t\u1ef7%' \n        THEN SAFE_CAST(REGEXP_REPLACE(REGEXP_REPLACE(price, r',', ''), r' t\u1ef7', '') AS DECIMAL) * 1000000000\n        WHEN REGEXP_REPLACE(price, r',', '.') LIKE '%tri\u1ec7u%' \n        THEN SAFE_CAST(REGEXP_REPLACE(REGEXP_REPLACE(price, r',', ''), r' tri\u1ec7u', '') AS DECIMAL) * 1000000\n        ELSE 0.0\n    END\n as price\n    ,CASE WHEN TRIM(price_m2) = '' THEN 'gi\u00e1 th\u1ecfa thu\u1eadn' ELSE LOWER(REGEXP_REPLACE(price_m2, r'tri\u1ec7u', 'tr')) END as price_m2\n    ,CASE WHEN TRIM(area) = '' THEN 0 ELSE CAST(TRIM(REGEXP_REPLACE(LOWER(area), r'[^0-9]', '')) AS INT64) END as area\n    ,CASE WHEN TRIM(area) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE REGEXP_REPLACE(LOWER(area), r'[^a-zA-Z\\s]', '') END as area_type\n    ,\n    CASE\n        WHEN REGEXP_CONTAINS(update_time, r'^\\d{2}/\\d{2}/\\d{4}$') THEN PARSE_DATE('%d/%m/%Y', update_time)\n        WHEN REGEXP_CONTAINS(update_time, r'^\\d{4}-\\d{2}-\\d{2}$') THEN DATE(update_time)\n    END \n as update_time\n    ,LOWER(link) as link\n    ,\n    CASE \n        WHEN LOWER(category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n as category_home\nFROM bds_data", "relation_name": "`data-engineering-439905`.`batdongsan`.`dim_bds`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:50.413869Z", "completed_at": "2024-11-20T17:31:50.437600Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:50.440249Z", "completed_at": "2024-11-20T17:31:52.261468Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.9159986972808838, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "92026f8a-7b54-4a33-aaae-8ccc1f454a5d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_house_area", "compiled": true, "compiled_code": "SELECT distinct bds.city\n    , avg(price) as avg_price    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.city", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_house_area`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:50.411280Z", "completed_at": "2024-11-20T17:31:50.434649Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:50.435622Z", "completed_at": "2024-11-20T17:31:52.263266Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.9182515144348145, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "7cb202aa-51b2-41bd-b701-c4c5a575af1d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_area_each_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , avg(area) as avg_area    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.category_home   \nORDER BY avg_area DESC", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_area_each_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:50.346119Z", "completed_at": "2024-11-20T17:31:50.413528Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:50.417958Z", "completed_at": "2024-11-20T17:31:52.264824Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.9238264560699463, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "4e326d3f-8cc9-460c-bde9-c6978b4258eb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.area_of_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , bds.area_type\n    , sum(area) as sum_area    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nWHERE area_type not like '%kh\u00f4ng t\u00ecm th\u1ea5y%'\nGROUP BY bds.category_home , bds.area_type", "relation_name": "`data-engineering-439905`.`batdongsan`.`area_of_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:50.415937Z", "completed_at": "2024-11-20T17:31:50.435266Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:50.438001Z", "completed_at": "2024-11-20T17:31:52.274865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8654201030731201, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "0d565aa7-0150-429d-a3a3-8ca1ae66a0a3", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_price_each_city", "compiled": true, "compiled_code": "SELECT *\nFROM(\n    SELECT distinct bds.city as city\n        , avg(price) as avg_price    \n    FROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\n    GROUP BY bds.city \n) as tb1\nWHERE city NOT LIKE '%Kh\u00f4ng t\u00ecm th\u1ea5y%' and  avg_price > 0", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_price_each_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:52.294400Z", "completed_at": "2024-11-20T17:31:52.300127Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:52.350142Z", "completed_at": "2024-11-20T17:31:54.001790Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7127792835235596, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "69e694d4-1c6f-4533-9f20-44f09c77a079", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_each_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , count(*) as quantity_bds    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.category_home   \nORDER BY quantity_bds DESC", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_each_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:52.277013Z", "completed_at": "2024-11-20T17:31:52.285850Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:52.286695Z", "completed_at": "2024-11-20T17:31:54.003608Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7318251132965088, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "aa112070-6adf-41ed-bf8c-726de0a1f9d7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.max_price_city", "compiled": true, "compiled_code": "with final as (\n    SELECT *\n        , ROW_NUMBER() OVER(ORDER BY quantity_transaction DESC) as row_number\n    FROM(\n        SELECT bds.city\n        , count(*) AS quantity_transaction \n        FROM `data-engineering-439905`.`batdongsan`.`dim_bds` AS bds\n        GROUP BY bds.city\n    ) as tb1\n)\nSELECT city,quantity_transaction\nFROM final\nwhere row_number = 1", "relation_name": "`data-engineering-439905`.`batdongsan`.`max_price_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:52.282013Z", "completed_at": "2024-11-20T17:31:52.288750Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:52.291658Z", "completed_at": "2024-11-20T17:31:54.008279Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7352969646453857, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "4b0f5775-7e14-4ec9-8a8b-b33ee35005d4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_bds_hcm", "compiled": true, "compiled_code": "SELECT distinct bds.city\n    , count(*) as quantity_bds_hcm    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nwhere bds.city = \"H\u1ed3 Ch\u00ed Minh\"\nGROUP BY bds.city", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_bds_hcm`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:52.279504Z", "completed_at": "2024-11-20T17:31:52.286317Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:52.289541Z", "completed_at": "2024-11-20T17:31:54.010480Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7379989624023438, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "fb2c1dea-ef4c-4a0f-861a-54d4780a1698", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_bds_category_hcm", "compiled": true, "compiled_code": "SELECT distinct \n    CASE \n        WHEN LOWER(bds.category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(bds.category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(bds.category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(bds.category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(bds.category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(bds.category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(bds.category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(bds.category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n as category_home\n    , count(*) as quantity_bds_hcm    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nwhere bds.city = \"H\u1ed3 Ch\u00ed Minh\"\nGROUP BY \n    CASE \n        WHEN LOWER(bds.category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(bds.category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(bds.category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(bds.category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(bds.category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(bds.category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(bds.category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(bds.category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_bds_category_hcm`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-20T17:31:54.014689Z", "completed_at": "2024-11-20T17:31:54.016711Z"}, {"name": "execute", "started_at": "2024-11-20T17:31:54.017139Z", "completed_at": "2024-11-20T17:31:55.639306Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.626671314239502, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "be667eef-148b-4495-81f1-4f6a4501116d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_sale_home_in_week", "compiled": true, "compiled_code": "SELECT CAST(COUNT(DISTINCT bds.address) as INT64 ) AS unique_values_in_week\nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` AS bds\nWHERE DATE_DIFF(CURRENT_DATE(), bds.update_time, DAY) <= 7", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_sale_home_in_week`"}], "elapsed_time": 15.342642784118652, "args": {"use_colors_file": true, "populate_cache": true, "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "log_format_file": "debug", "partial_parse_file_diff": true, "version_check": true, "use_colors": true, "log_level_file": "debug", "cache_selected_only": false, "partial_parse": true, "log_level": "info", "log_path": "/home/kiet/Documents/Project/DBT/bds_dbt/logs", "introspect": true, "select": [], "favor_state": false, "printer_width": 80, "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "log_format": "default", "log_file_max_bytes": 10485760, "strict_mode": false, "quiet": false, "profiles_dir": "/home/kiet/.dbt", "indirect_selection": "eager", "which": "run", "invocation_command": "dbt run", "print": true, "macro_debugging": false, "project_dir": "/home/kiet/Documents/Project/DBT/bds_dbt", "enable_legacy_logger": false, "static_parser": true, "defer": false, "send_anonymous_usage_stats": true, "show_resource_report": false, "vars": {}, "write_json": true}}