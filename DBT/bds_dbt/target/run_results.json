{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-11-17T06:42:29.287324Z", "invocation_id": "4c82966a-b68f-4ead-97c1-41c483bacfbd", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:18.006357Z", "completed_at": "2024-11-17T06:42:18.014213Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:18.014693Z", "completed_at": "2024-11-17T06:42:24.376390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.370889902114868, "adapter_response": {"_message": "CREATE TABLE (190.4k rows, 70.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 190408, "bytes_processed": 74048120, "bytes_billed": 74448896, "location": "US", "project_id": "data-engineering-439905", "job_id": "0bc8879d-b75e-431c-9ee2-22ba6b910741", "slot_ms": 35618}, "message": "CREATE TABLE (190.4k rows, 70.6 MiB processed)", "failures": null, "unique_id": "model.bds_dbt.dim_bds", "compiled": true, "compiled_code": "\n\nWITH bds_data AS (\n    SELECT * \n    FROM `data-engineering-439905`.`batdongsan`.`thong_tin_ban_dat` as bds\n    WHERE bds.update_time NOT IN (' ', '')\n)\n\nSELECT \n    CASE WHEN TRIM(address_text) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(address_text) END as address\n    ,CASE WHEN TRIM(district) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(district) END as district\n    ,CASE WHEN TRIM(city) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE LOWER(city) END as city\n    ,\n    CASE \n        WHEN REGEXP_REPLACE(price, r',', '.') LIKE '%t\u1ef7%' \n        THEN SAFE_CAST(REGEXP_REPLACE(REGEXP_REPLACE(price, r',', ''), r' t\u1ef7', '') AS DECIMAL) * 1000000000\n        WHEN REGEXP_REPLACE(price, r',', '.') LIKE '%tri\u1ec7u%' \n        THEN SAFE_CAST(REGEXP_REPLACE(REGEXP_REPLACE(price, r',', ''), r' tri\u1ec7u', '') AS DECIMAL) * 1000000\n        ELSE 0.0\n    END\n as price\n    ,CASE WHEN TRIM(price_m2) = '' THEN 'gi\u00e1 th\u1ecfa thu\u1eadn' ELSE LOWER(REGEXP_REPLACE(price_m2, r'tri\u1ec7u', 'tr')) END as price_m2\n    ,CASE WHEN TRIM(area) = '' THEN 0 ELSE CAST(TRIM(REGEXP_REPLACE(LOWER(area), r'[^0-9]', '')) AS INT64) END as area\n    ,CASE WHEN TRIM(area) = '' THEN 'kh\u00f4ng t\u00ecm th\u1ea5y' ELSE REGEXP_REPLACE(LOWER(area), r'[^a-zA-Z\\s]', '') END as area_type\n    ,\n    CASE\n        WHEN REGEXP_CONTAINS(update_time, r'^\\d{2}/\\d{2}/\\d{4}$') THEN PARSE_DATE('%d/%m/%Y', update_time)\n        WHEN REGEXP_CONTAINS(update_time, r'^\\d{4}-\\d{2}-\\d{2}$') THEN DATE(update_time)\n    END \n as update_time\n    ,LOWER(link) as link\n    ,\n    CASE \n        WHEN LOWER(category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n as category_home\nFROM bds_data", "relation_name": "`data-engineering-439905`.`batdongsan`.`dim_bds`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:24.392493Z", "completed_at": "2024-11-17T06:42:24.411550Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:24.424387Z", "completed_at": "2024-11-17T06:42:26.003965Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6183383464813232, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "1d366656-bda7-488c-9121-262d3b93efe6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_area_each_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , avg(area) as avg_area    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.category_home   \nORDER BY avg_area DESC", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_area_each_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:24.396096Z", "completed_at": "2024-11-17T06:42:24.423925Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:24.426890Z", "completed_at": "2024-11-17T06:42:26.005780Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6159546375274658, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "40cdba34-ad53-4edb-b611-556d615cf986", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_house_area", "compiled": true, "compiled_code": "SELECT distinct bds.city\n    , avg(price) as avg_price    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.city", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_house_area`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:24.398342Z", "completed_at": "2024-11-17T06:42:24.426368Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:24.429441Z", "completed_at": "2024-11-17T06:42:26.007461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6170892715454102, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "fef64a48-b4ca-4ae5-a737-89464bf5c69a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.avg_price_each_city", "compiled": true, "compiled_code": "SELECT *\nFROM(\n    SELECT distinct bds.city as city\n        , avg(price) as avg_price    \n    FROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\n    GROUP BY bds.city \n) as tb1\nWHERE city NOT LIKE '%Kh\u00f4ng t\u00ecm th\u1ea5y%' and  avg_price > 0", "relation_name": "`data-engineering-439905`.`batdongsan`.`avg_price_each_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:24.386250Z", "completed_at": "2024-11-17T06:42:24.395422Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:24.401372Z", "completed_at": "2024-11-17T06:42:26.008936Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6267116069793701, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "6bb98530-c76d-491c-b51c-bf7a800ad03b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.area_of_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , bds.area_type\n    , sum(area) as sum_area    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nWHERE area_type not like '%kh\u00f4ng t\u00ecm th\u1ea5y%'\nGROUP BY bds.category_home , bds.area_type", "relation_name": "`data-engineering-439905`.`batdongsan`.`area_of_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:26.021320Z", "completed_at": "2024-11-17T06:42:26.040394Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:26.045033Z", "completed_at": "2024-11-17T06:42:27.642416Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6244373321533203, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "3c9d5885-7c36-422c-bddc-72bf4ec0bdb7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.max_price_city", "compiled": true, "compiled_code": "with final as (\n    SELECT *\n        , ROW_NUMBER() OVER(ORDER BY quantity_transaction DESC) as row_number\n    FROM(\n        SELECT bds.city\n        , count(*) AS quantity_transaction \n        FROM `data-engineering-439905`.`batdongsan`.`dim_bds` AS bds\n        GROUP BY bds.city\n    ) as tb1\n)\nSELECT city,quantity_transaction\nFROM final\nwhere row_number = 1", "relation_name": "`data-engineering-439905`.`batdongsan`.`max_price_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:26.025502Z", "completed_at": "2024-11-17T06:42:26.036882Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:26.040788Z", "completed_at": "2024-11-17T06:42:27.643939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6249992847442627, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "1418aa0d-e509-4e1e-ba5a-8aa1e2ae7243", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_bds_hcm", "compiled": true, "compiled_code": "SELECT distinct bds.city\n    , count(*) as quantity_bds_hcm    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nwhere bds.city = \"H\u1ed3 Ch\u00ed Minh\"\nGROUP BY bds.city", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_bds_hcm`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:26.022328Z", "completed_at": "2024-11-17T06:42:26.036259Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:26.037893Z", "completed_at": "2024-11-17T06:42:27.645455Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6269373893737793, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "a5cd04c0-9c79-47c2-af73-5f7fae477f2a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_bds_category_hcm", "compiled": true, "compiled_code": "SELECT distinct \n    CASE \n        WHEN LOWER(bds.category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(bds.category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(bds.category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(bds.category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(bds.category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(bds.category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(bds.category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(bds.category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n as category_home\n    , count(*) as quantity_bds_hcm    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nwhere bds.city = \"H\u1ed3 Ch\u00ed Minh\"\nGROUP BY \n    CASE \n        WHEN LOWER(bds.category_home) LIKE '%ban nha mat pho%' THEN 'ban nha mat pho'\n        WHEN LOWER(bds.category_home) LIKE '%ban can ho chung cu%' THEN 'ban can ho chung cu'\n        WHEN LOWER(bds.category_home) LIKE '%ban dat%' THEN 'ban dat'\n        WHEN LOWER(bds.category_home) LIKE '%ban shophouse%' THEN 'ban shophouse'\n        WHEN LOWER(bds.category_home) LIKE '%ban kho nha xuong%' THEN 'ban kho nha xuong'\n        WHEN LOWER(bds.category_home) LIKE '%ban trang trai khu nghi duong' THEN 'ban trang trai khu nghi duong'\n        WHEN LOWER(bds.category_home) LIKE '%ban condotel%' THEN 'ban condotel'\n        WHEN LOWER(bds.category_home) LIKE '%ban loai bat dong san khac%' THEN 'ban loai bat dong san khac'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha biet thu%' THEN 'ban nha biet thu'\n        WHEN LOWER(bds.category_home) LIKE '%ban nha rieng%' THEN 'ban nha biet thu'\n        ELSE 'kh\u00e1c'\n    END\n", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_bds_category_hcm`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:26.028112Z", "completed_at": "2024-11-17T06:42:26.037489Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:26.042919Z", "completed_at": "2024-11-17T06:42:27.646915Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6275725364685059, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "cb3514a3-d6d6-4fcf-a5c5-1b08469ec47d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_each_category", "compiled": true, "compiled_code": "SELECT distinct bds.category_home\n    , count(*) as quantity_bds    \nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` as bds\nGROUP BY bds.category_home   \nORDER BY quantity_bds DESC", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_each_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-17T06:42:27.654269Z", "completed_at": "2024-11-17T06:42:27.657087Z"}, {"name": "execute", "started_at": "2024-11-17T06:42:27.657522Z", "completed_at": "2024-11-17T06:42:29.281234Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6279282569885254, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "data-engineering-439905", "job_id": "fea8ba4f-7ad2-468b-bf68-138825eec599", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.bds_dbt.quantity_sale_home_in_week", "compiled": true, "compiled_code": "SELECT CAST(COUNT(DISTINCT bds.address) as INT64 ) AS unique_values_in_week\nFROM `data-engineering-439905`.`batdongsan`.`dim_bds` AS bds\nWHERE DATE_DIFF(CURRENT_DATE(), bds.update_time, DAY) <= 7", "relation_name": "`data-engineering-439905`.`batdongsan`.`quantity_sale_home_in_week`"}], "elapsed_time": 12.531349182128906, "args": {"invocation_command": "dbt run", "populate_cache": true, "enable_legacy_logger": false, "partial_parse_file_diff": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "log_format": "default", "vars": {}, "print": true, "log_level_file": "debug", "project_dir": "/home/kiet/Documents/Project/DBT/bds_dbt", "static_parser": true, "printer_width": 80, "version_check": true, "macro_debugging": false, "require_resource_names_without_spaces": false, "partial_parse": true, "show_resource_report": false, "send_anonymous_usage_stats": true, "exclude": [], "select": [], "empty": false, "use_colors_file": true, "introspect": true, "defer": false, "log_level": "info", "indirect_selection": "eager", "profiles_dir": "/home/kiet/.dbt", "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "write_json": true, "favor_state": false, "cache_selected_only": false, "log_path": "/home/kiet/Documents/Project/DBT/bds_dbt/logs", "source_freshness_run_project_hooks": false, "quiet": false, "which": "run"}}